---
id: "E04-T007"
title: "Chat API routes"
status: "todo"
priority: "high"
labels: [backend, api]
assignee: ""
workflow_state: "DRAFT"
epic: "E04"
depends_on: ["E04-T006"]
blocks: ["E04-T008"]
breakpoint: false
assigned_agent: ""
created_at: "2026-01-12T00:00:00Z"
updated_at: "2026-01-12T00:00:00Z"
spec_file: ""
test_files: []
code_files: []
pr_url: ""
---

# E04-T007: Chat API routes

## Description

Implement REST routes for session management: create session, get session, list sessions, complete session, send message (SSE).

## Acceptance Criteria

- [ ] AC1: POST /sessions - create new session from tool
- [ ] AC2: GET /sessions/:id - get session with messages
- [ ] AC3: GET /sessions - list user's sessions (paginated)
- [ ] AC4: POST /sessions/:id/messages - send message (SSE streaming)
- [ ] AC5: PATCH /sessions/:id/complete - mark session completed
- [ ] AC6: Permission checks (user owns session)
- [ ] AC7: Validation with Zod schemas
- [ ] AC8: Error responses follow convention
- [ ] AC9: Rate limiting on message endpoint
- [ ] AC10: Tests verify all routes

## Technical Notes

Routes:
```typescript
// POST /sessions { toolId: uuid }
// GET /sessions/:id
// GET /sessions?cursor=...&limit=20
// POST /sessions/:id/messages { content: string } (SSE)
// PATCH /sessions/:id/complete
```

## History

| Date | State | Agent | Notes |
| ---- | ----- | ----- | ----- |
| 2026-01-12 | DRAFT | pm | Task created |

## Reviews

### Plan Review
- **Reviewer:** architect
- **Date:**
- **Verdict:**
- **Notes:**

### Code Review
- **Reviewer:** reviewer
- **Date:**
- **Verdict:**
- **Notes:**

### QA Review
- **Reviewer:** qa
- **Date:**
- **Verdict:**
- **Notes:**
