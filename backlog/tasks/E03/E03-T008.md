---
id: "E03-T008"
title: "Theme service with inheritance logic"
status: "todo"
priority: "medium"
labels: [backend, api]
assignee: ""
workflow_state: "DRAFT"
epic: "E03"
depends_on: ["E03-T004"]
blocks: []
breakpoint: false
assigned_agent: ""
created_at: "2026-01-12T00:00:00Z"
updated_at: "2026-01-12T00:00:00Z"
spec_file: ""
test_files: []
code_files: []
pr_url: ""
---

# E03-T008: Theme service with inheritance logic

## Description

Implement ThemeService that resolves theme settings from group hierarchy, merges parent themes, and generates CSS variables.

## Acceptance Criteria

- [ ] AC1: ThemeService with resolveTheme method
- [ ] AC2: Walk up ltree hierarchy to merge theme settings
- [ ] AC3: Child themes override parent values
- [ ] AC4: Generate CSS custom properties from theme object
- [ ] AC5: GET /groups/:id/theme - get computed theme
- [ ] AC6: PATCH /groups/:id/theme - update theme (group_admin)
- [ ] AC7: Default theme if no hierarchy themes found
- [ ] AC8: Theme validation with Zod schema
- [ ] AC9: CSS output format: :root { --color-primary: #xxx; }
- [ ] AC10: Tests verify inheritance chain

## Technical Notes

Theme stored in groups.settings.theme. Walk up path to merge.

## History

| Date | State | Agent | Notes |
| ---- | ----- | ----- | ----- |
| 2026-01-12 | DRAFT | pm | Task created |

## Reviews

### Plan Review
- **Reviewer:** architect
- **Date:**
- **Verdict:**
- **Notes:**

### Code Review
- **Reviewer:** reviewer
- **Date:**
- **Verdict:**
- **Notes:**

### QA Review
- **Reviewer:** qa
- **Date:**
- **Verdict:**
- **Notes:**
