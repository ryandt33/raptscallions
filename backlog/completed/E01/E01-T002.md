---
id: E01-T002
title: Setup packages/core with Zod schemas
status: Done
priority: high
labels:
  - backend
  - types
assignee: ""
workflow_state: DONE
epic: E01
agentic_style: "prescriptive"
depends_on:
  - E01-T001
blocks: []
breakpoint: false
assigned_agent: writer
created_at: 2025-01-11T00:00:00Z
updated_at: 2026-01-12T00:00:00Z
started_at: 2026-01-11T15:22:03.868Z
completed_at: 2026-01-12T00:00:00Z
spec_file: backlog/docs/specs/E01/E01-T002-spec.md
test_files:
  - packages/core/src/__tests__/factories.ts
  - packages/core/src/__tests__/schemas/user.schema.test.ts
  - packages/core/src/__tests__/schemas/group.schema.test.ts
  - packages/core/src/__tests__/errors/errors.test.ts
  - packages/core/src/__tests__/integration/schema-composition.test.ts
  - packages/core/src/__tests__/integration/cross-package-imports.test.ts
  - packages/core/vitest.config.ts
code_files:
  - packages/core/src/index.ts
  - packages/core/src/schemas/index.ts
  - packages/core/src/schemas/user.schema.ts
  - packages/core/src/schemas/group.schema.ts
  - packages/core/src/errors/index.ts
  - packages/core/src/errors/base.error.ts
  - packages/core/src/errors/common.error.ts
  - packages/core/src/types/index.ts
  - packages/core/tsconfig.json
pr_url: ""
---

# E01-T002: Setup packages/core with Zod schemas

## Description

Create the @raptscallions/core package for shared TypeScript types and Zod validation schemas. This package will be imported by all other packages and apps for type-safe validation.

## Acceptance Criteria

- [x] AC1: Package exports from src/index.ts
- [x] AC2: src/types/ directory for TypeScript interfaces
- [x] AC3: src/schemas/ directory for Zod schemas
- [x] AC4: Zod 3.x installed as dependency
- [x] AC5: Types inferred from Zod schemas using z.infer<>
- [x] AC6: Initial schemas: userSchema, groupSchema (basic structure)
- [x] AC7: src/errors/ directory with typed error classes
- [x] AC8: Package builds with tsup or tsc
- [x] AC9: Exports both ESM and CJS formats
- [x] AC10: Package can be imported from other workspace packages

## Technical Notes

- Use `import type` for type-only imports
- Prefer interfaces for objects, types for unions/utilities
- Error classes should extend a base AppError class
- Include error codes enum for consistent error identification
- Schemas should be composable (base schemas extended for create/update)

Example schema pattern:
```typescript
export const userBaseSchema = z.object({
  email: z.string().email(),
  name: z.string().min(1).max(100),
});

export const createUserSchema = userBaseSchema;
export const updateUserSchema = userBaseSchema.partial();

export type User = z.infer<typeof userBaseSchema>;
export type CreateUser = z.infer<typeof createUserSchema>;
```

## History

| Date       | State      | Agent    | Notes                                   |
| ---------- | ---------- | -------- | --------------------------------------- |
| 2025-01-11 | DRAFT      | pm       | Task created                            |
| 2026-01-12 | ANALYZED   | analyst  | Implementation spec created             |
| 2026-01-12 | UX_REVIEW  | designer | UX Review: NOT_APPLICABLE (no frontend) |
| 2026-01-11 | PLAN_REVIEW | architect | Plan approved |
| 2026-01-12 | UI_REVIEW  | designer | UI Review: NOT_APPLICABLE (no frontend code) → CODE_REVIEW |
| 2026-01-12 | CODE_REVIEW | reviewer | Code Review: APPROVED → QA_REVIEW |
| 2026-01-12 | QA_REVIEW | qa | QA Review: APPROVED → DOCS_UPDATE |
| 2026-01-12 | DOCS_UPDATE | writer | Docs updated: ARCHITECTURE.md, CONVENTIONS.md → DONE |


## Reviews

### Plan Review

- **Reviewer:** architect
- **Date:** 2026-01-12
- **Verdict:** APPROVED (after NEEDS_CHANGES round)
- **Notes:** See spec file for architectural review details

### Code Review

- **Reviewer:** reviewer
- **Date:** 2026-01-12
- **Verdict:** APPROVED
- **Notes:** All 94 tests pass. TypeScript strict mode passes. Architect concerns addressed. See `backlog/docs/reviews/E01/E01-T002-code-review.md`

### QA Review

- **Reviewer:** qa
- **Date:** 2026-01-12
- **Verdict:** APPROVED
- **Notes:** All 94 tests pass. All acceptance criteria verified. Edge cases tested. See `backlog/docs/reviews/E01/E01-T002-qa-report.md`

## Documentation Updates

- **Reviewer:** writer
- **Date:** 2026-01-12
- **Files Updated:**
  - `docs/ARCHITECTURE.md` - Updated `packages/core/` structure section to include `errors/` directory and clarify that types are re-exported from schemas
  - `docs/CONVENTIONS.md` - Updated Error Handling section with actual implementation patterns including `ErrorCode` enum, `ErrorDetails` type, and `toJSON()` method
