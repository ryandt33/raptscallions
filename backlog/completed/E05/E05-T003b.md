---
id: "E05-T003b"
title: "MinIO Docker Compose integration for local development"
status: "done"
priority: "high"
task_type: "backend"
workflow: "infrastructure"
labels: [infrastructure, docker, minio, devex]
assignee: ""
workflow_state: "PR_READY"
completed_at: "2026-01-16"
analysis_file: "backlog/docs/analysis/E05/E05-T003b-analysis.md"
epic: "E05"
agentic_style: "outcome-focused"
depends_on: []
blocks: ["E05-T003c"]
breakpoint: false
assigned_agent: ""
created_at: "2026-01-16T00:00:00Z"
updated_at: "2026-01-16T00:00:00Z"
spec_file: "backlog/docs/specs/E05/E05-T003b-spec.md"
test_files: []
code_files: ["docker-compose.yml", ".env.example", "README.md"]
pr_url: ""
---

# E05-T003b: MinIO Docker Compose integration for local development

## Description

Add MinIO (S3-compatible object storage) to the Docker Compose development environment so developers can test S3 storage locally without cloud credentials. Include automatic bucket creation and health checks.

## Why This Matters

Developers need to test file storage functionality without AWS credentials or cloud costs. MinIO provides a local S3-compatible service that behaves identically to production S3, enabling realistic local development and testing.

## Acceptance Criteria

- [x] AC1: MinIO service starts with `docker compose up`
- [x] AC2: MinIO API is accessible on port 9000
- [x] AC3: MinIO web console is accessible on port 9001 for debugging
- [x] AC4: Default bucket is automatically created on first startup
- [x] AC5: MinIO data persists across container restarts (volume mount)
- [x] AC6: API service waits for MinIO health check before starting
- [x] AC7: Environment variables are documented in .env.example
- [x] AC8: README includes instructions for accessing MinIO console

## Constraints

- No secrets in docker-compose.yml (use .env for credentials)
- Health check must be reliable (MinIO-specific endpoint)
- Bucket auto-creation must be idempotent (safe to run multiple times)
- Must not conflict with existing services (ports 9000, 9001 available)

## Workflow

**Category:** `infrastructure`

**Rationale:** Docker/infrastructure changes don't require TDD - focus on configuration and verification.

**Phases:**
1. `/analyze` - Review existing docker-compose.yml structure
2. Human approval of approach
3. `/review-plan` - Architect validates configuration
4. `/implement` - Add MinIO service configuration
5. `/review-code` - Verify configuration correctness
6. `/qa` - Manual verification (start services, test connectivity)
7. `/update-docs` - Update README and .env.example
8. PR creation

## Out of Scope

- S3 backend code implementation (E05-T003a)
- Integration tests (E05-T003c)
- Production S3 setup (E05-T003d)
- MinIO clustering/replication
- SSL/TLS for MinIO (development only)
- MinIO user management beyond root credentials

## Context

- Existing docker-compose.yml has postgres and redis services as patterns
- MinIO official image: `minio/minio:latest`
- MinIO client (mc) can be used for bucket initialization
- See E05 epic notes for environment variable naming conventions

## Reviews

| Type | Verdict | Link |
| ---- | ------- | ---- |
| Code Review | APPROVED | [E05-T003b-code-review.md](../../docs/reviews/E05/E05-T003b-code-review.md) |
| QA Review | PASSED | [E05-T003b-qa-report.md](../../docs/reviews/E05/E05-T003b-qa-report.md) |

## History

| Date | State | Agent | Notes |
| ---- | ----- | ----- | ----- |
| 2026-01-16 | PR_READY | writer | Documentation updated: KB storage docs, ARCHITECTURE.md, Ubuntu setup guide |
| 2026-01-16 | DONE | qa | QA PASSED; all 8 ACs verified through manual Docker testing |
| 2026-01-16 | QA_REVIEW | reviewer | Code review APPROVED; all acceptance criteria verified, follows established patterns |
| 2026-01-16 | IMPLEMENTED | developer | Added MinIO and minio-init services, updated API dependencies, added volume, updated .env.example and README.md |
| 2026-01-16 | APPROVED | architect | Approach A selected; spec created with docker-compose patterns |
| 2026-01-16 | ANALYZED | analyst | Analysis complete with 3 approaches; Approach A (init container) recommended |
| 2026-01-16 | REPLANNED | pm | Split from E05-T003 - focused on Docker infrastructure |
| 2026-01-13 | DRAFT | pm | Original task created for Epic E05 |

## Documentation Updates

**Writer:** writer
**Date:** 2026-01-16

### Files Updated

| File | Changes |
| ---- | ------- |
| `apps/docs/src/storage/patterns/s3-backend.md` | Added "Local Development with MinIO" section with setup instructions, console access, and configuration |
| `apps/docs/src/storage/index.md` | Added "Local Development" section and E05-T003b implementation reference |
| `apps/docs/src/contributing/ubuntu-setup.md` | Updated Docker services section to include MinIO, added MinIO management commands |
| `docs/ARCHITECTURE.md` | Updated container architecture diagram to include MinIO, updated docker-compose example |

### Files Created

None - this task only required updates to existing documentation.

### Summary

Documentation updates focus on developer experience for local S3 storage testing:
- **KB Storage Docs**: New "Local Development with MinIO" section explains how to use MinIO for realistic S3 testing without cloud credentials. Includes console access, port configuration, and environment variable setup for both in-Docker and host-machine development scenarios.
- **Ubuntu Setup Guide**: Updated to include MinIO in the standard Docker service startup, with clear port documentation and MinIO-specific management commands.
- **Architecture Docs**: Updated container diagram to show MinIO as part of the infrastructure layer alongside PostgreSQL and Redis.

### Verification

- [x] All code references are accurate
- [x] Examples are runnable
- [x] Links work (internal KB links verified)
- [x] Formatting is consistent with existing docs
